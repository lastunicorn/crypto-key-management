<UserControl
    x:Class="DustInTheWind.CryptoKeyManagement.Wpf.Presentation.PluginsPage.PluginView"
    
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:DustInTheWind.CryptoKeyManagement.Wpf.Presentation.PluginsPage"
    
    mc:Ignorable="d"
    d:DesignHeight="120"
    d:DesignWidth="600">

    <UserControl.Resources>
        <local:BoolToStatusBrushConverter x:Key="BoolToStatusBrushConverter"/>
        <local:InvertBooleanToVisibilityConverter x:Key="InvertBooleanToVisibilityConverter"/>
        <local:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </UserControl.Resources>

    <Border
        BorderThickness="1"
        CornerRadius="4"
        Margin="0 0 0 10"
        Padding="15">

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="36"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Plugin Name and Status -->
            <TextBlock
                Grid.Row="0"
                Text="{Binding Name}"
                FontSize="16"
                FontWeight="Bold"
                Margin="0 0 10 0"/>

            <!-- Set as Default Button -->
            <Button
                Grid.Row="0"
                Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=SetDefaultPluginCommand}"
                CommandParameter="{Binding Id}"
                Visibility="{Binding IsDefault, Converter={StaticResource InvertBooleanToVisibilityConverter}}"
                ToolTip="Set this plugin as the default formatter"
                HorizontalAlignment="Right"
                VerticalAlignment="Top"
                Height="24"
                Width="24">

                <Button.Template>
                    <ControlTemplate TargetType="Button">

                        <Ellipse
                            Width="24"
                            Height="24"
                            Fill="Transparent"
                            Stroke="Green"
                            StrokeThickness="3"/>

                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Cursor" Value="Hand"/>
                            </Trigger>
                        </ControlTemplate.Triggers>

                    </ControlTemplate>
                </Button.Template>
            </Button>

            <Ellipse
                Grid.Row="0"
                Grid.Column="0"
                Width="24"
                Height="24"
                Fill="Green"
                HorizontalAlignment="Right"
                VerticalAlignment="Top"
                Visibility="{Binding IsDefault, Converter={StaticResource BooleanToVisibilityConverter}}"/>

            <!-- Assembly Info -->
            <StackPanel
                Grid.Row="1"
                Orientation="Horizontal"
                Margin="20 0 0 0">

                <TextBlock
                    Grid.Column="0"
                    Text="Assembly:"
                    FontWeight="SemiBold"
                    Margin="0 0 8 0"/>

                <TextBlock
                    Grid.Column="1"
                    Text="{Binding AssemblyName}"/>
            </StackPanel>

            <!-- Version Info -->
            <StackPanel
                Grid.Row="2"
                Orientation="Horizontal"
                Margin="20 0 0 0">

                <TextBlock
                    Grid.Column="2"
                    Text="Version:"
                    FontWeight="SemiBold"
                    Margin="0 0 8 0"/>

                <TextBlock
                    Grid.Column="3"
                    Text="{Binding Version}"/>
            </StackPanel>

            <!-- Plugin ID -->
            <StackPanel
                Grid.Row="3"
                Orientation="Horizontal"
                Margin="20 8 0 0">

                <TextBlock
                    Text="ID:"
                    FontWeight="SemiBold"
                    Margin="0 0 8 0"/>

                <TextBlock
                    Text="{Binding Id}"
                    FontFamily="Consolas"
                    FontSize="11"
                    Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                    VerticalAlignment="Center"
                    Margin="0 0 5 0"/>

                <Button
                    Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=CopyToClipboardCommand}"
                    CommandParameter="{Binding Id}"
                    Background="Transparent"
                    Width="16"
                    Height="16"
                    VerticalAlignment="Center"
                    ToolTip="Copy ID to clipboard"
                    Cursor="Hand">

                    <Button.Template>
                        <ControlTemplate TargetType="Button">

                            <Border
                                Background="{TemplateBinding Background}"
                                CornerRadius="2"
                                Padding="2">

                                <Image
                                    Source="{DynamicResource CopyIcon}"
                                    Stretch="Uniform"/>
                            </Border>

                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="{DynamicResource SurfaceHoverBrush}"/>
                                </Trigger>
                            </ControlTemplate.Triggers>

                        </ControlTemplate>
                    </Button.Template>
                </Button>

            </StackPanel>
        </Grid>
    </Border>
</UserControl>