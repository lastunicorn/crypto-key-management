<UserControl
    x:Class="DustInTheWind.CryptoKeyManagement.Wpf.Presentation.PluginsPage.PluginView"
    
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:DustInTheWind.CryptoKeyManagement.Wpf.Presentation.PluginsPage"
    
    mc:Ignorable="d"
    d:DesignHeight="120"
    d:DesignWidth="600">

    <UserControl.Resources>
        <local:BoolToStatusBrushConverter x:Key="BoolToStatusBrushConverter"/>
        <local:InvertBooleanToVisibilityConverter x:Key="InvertBooleanToVisibilityConverter"/>
        <local:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </UserControl.Resources>

    <Border
        BorderThickness="1"
        CornerRadius="4"
        Margin="0 0 0 10"
        Padding="15">

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Plugin Name and Status -->
            <DockPanel
                Grid.Row="0"
                Grid.Column="0">

                <Border
                    DockPanel.Dock="Right"
                    Background="{Binding IsDefault, Converter={StaticResource BoolToStatusBrushConverter}}"
                    CornerRadius="12"
                    Padding="10 5"
                    Visibility="{Binding IsDefault, Converter={StaticResource BooleanToVisibilityConverter}}">

                    <TextBlock
                        Text="Active"
                        FontSize="12"
                        Foreground="DarkGreen"
                        FontWeight="SemiBold"
                        HorizontalAlignment="Center"/>
                </Border>

                <!-- Set as Default Button -->
                <Button
                    DockPanel.Dock="Right"
                    Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=SetDefaultPluginCommand}"
                    CommandParameter="{Binding Id}"
                    Content="Set as Default"
                    Visibility="{Binding IsDefault, Converter={StaticResource InvertBooleanToVisibilityConverter}}"
                    Padding="10 5"
                    Margin="10 0 0 0"
                    Background="{DynamicResource AccentBrush}"
                    Foreground="White"
                    BorderThickness="0"
                    Cursor="Hand"
                    ToolTip="Set this plugin as the default formatter"/>

                <TextBlock
                    Text="{Binding Name}"
                    FontSize="16"
                    FontWeight="Bold"
                    Margin="0 0 10 0"/>
            </DockPanel>

            <!-- Assembly and Version Info -->
            <Grid
                Grid.Row="1"
                Grid.ColumnSpan="2"
                Margin="0,8,0,0">

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <TextBlock
                    Grid.Column="0"
                    Text="Assembly:"
                    FontWeight="SemiBold"
                    Margin="0 0 5 0"/>

                <TextBlock
                    Grid.Column="1"
                    Text="{Binding AssemblyName}"
                    Margin="0 0 20 0"/>

                <TextBlock
                    Grid.Column="2"
                    Text="Version:"
                    FontWeight="SemiBold"
                    Margin="0 0 5 0"/>

                <TextBlock
                    Grid.Column="3"
                    Text="{Binding Version}"/>
            </Grid>

            <!-- Plugin ID -->
            <StackPanel
                Grid.Row="2"
                Grid.ColumnSpan="2"
                Orientation="Horizontal"
                Margin="0 8 0 0">

                <TextBlock
                    Text="ID:"
                    FontWeight="SemiBold"
                    Margin="0 0 5 0"/>

                <TextBlock
                    Text="{Binding Id}"
                    FontFamily="Consolas"
                    FontSize="11"
                    Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                    VerticalAlignment="Center"
                    Margin="0 0 5 0"/>

                <Button
                    Command="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=CopyToClipboardCommand}"
                    CommandParameter="{Binding Id}"
                    Background="Transparent"
                    Width="16"
                    Height="16"
                    VerticalAlignment="Center"
                    ToolTip="Copy ID to clipboard"
                    Cursor="Hand">

                    <Button.Template>
                        <ControlTemplate TargetType="Button">

                            <Border
                                Background="{TemplateBinding Background}"
                                CornerRadius="2"
                                Padding="2">

                                <Image
                                    Source="{DynamicResource CopyIcon}"
                                    Stretch="Uniform"/>
                            </Border>

                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="{DynamicResource SurfaceHoverBrush}"/>
                                </Trigger>
                            </ControlTemplate.Triggers>

                        </ControlTemplate>
                    </Button.Template>
                </Button>

            </StackPanel>
        </Grid>
    </Border>
</UserControl>